# Библиотека Decimal

Библиотека Decimal предоставляет десятичный тип значения, который представляет десятичные числа в диапазоне от положительных 79 228 162 514 264 337 593 543 950 335 до отрицательных 79 228 162 514 264 337 593 543 950 335. Тип Decimal подходит для финансовых расчетов, требующих большого количества значащих целых и дробных цифр и отсутствия ошибок округления. Тип Decimal не устраняет необходимость округления. Скорее, это минимизирует ошибки из-за округления.

## Двоичное представление
Двоичное представление десятичного числа состоит из 1-битного знака, 96-битного целого числа и коэффициента масштабирования, используемого для деления целого числа и указания того, какая его часть является десятичной дробью. Коэффициент масштабирования неявно представляет собой число 10, возведенное в степень от 0 до 28. Десятичное число может быть реализовано в виде четырехэлементного массива 32-разрядных целых чисел со знаком (int32_t).

### Арифметические операторы

| Название оператора | Оператор  | Функция                                                                            | 
| ------ | ------ |------------------------------------------------------------------------------------|
| Сложение | + | int st_add(st_decimal value_1, st_decimal value_2, st_decimal *result)         |
| Вычитание | - | int st_sub(st_decimal value_1, st_decimal value_2, st_decimal *result)         |
| Умножение | * | int st_mul(st_decimal value_1, st_decimal value_2, st_decimal *result) | 
| Деление | / | int st_div(st_decimal value_1, st_decimal value_2, st_decimal *result) |
| Остаток от деления | Mod | int st_mod(st_decimal value_1, st_decimal value_2, st_decimal *result) |

Функции возвращают код ошибки:  
- 0 - OK  
- 1 - число слишком велико или равно бесконечности
- 2 - число слишком мало или равно отрицательной бесконечности
- 3 - деление на 0

*Уточнение про числа, не вмещающиеся в мантиссу:*
- *При получении чисел, не вмещающихся в мантиссу при арифметических операциях, использовать банковское округление (например, 79,228,162,514,264,337,593,543,950,335 - 0.6 = 79,228,162,514,264,337,593,543,950,334)*

### Операторы сравнение

| Название оператора | Оператор  | Функция | 
| ------ | ------ | ------ |
| Меньше  | < | int st_is_less(st_decimal, st_decimal) |
| Меньше или равно | <= | int st_is_less_or_equal(st_decimal, st_decimal) | 
| Больше | \> |  int st_is_greater(st_decimal, st_decimal) |
| Больше или равно | \>= | int st_is_greater_or_equal(st_decimal, st_decimal) | 
| Равно | == |  int st_is_equal(st_decimal, st_decimal) |
| Не равно | != |  int st_is_not_equal(st_decimal, st_decimal) |

Возвращаемое значение:
- 0 - FALSE
- 1 - TRUE

### Преобразователи 

| Преобразователь | Функция | 
| ------ | ------ |
| Из int | int st_from_int_to_decimal(int src, st_decimal *dst) |
| Из float  | int st_from_float_to_decimal(float src, st_decimal *dst) |
| В int  | int st_from_decimal_to_int(st_decimal src, int *dst) |
| В float  | int st_from_decimal_to_float(st_decimal src, float *dst) |

Возвращаемое значение - код ошибки:
 - 0 - OK
 - 1 - ошибка конвертации

*Уточнение про преобразование числа типа float:*
- *Если числа слишком малы (0 < |x| < 1e-28), вернуть ошибку и значение, равное 0*
- *Если числа слишком велики (|x| > 79,228,162,514,264,337,593,543,950,335) или равны бесконечности, вернуть ошибку*
- *При обработке числа с типом float преобразовывать все содержащиеся в нём значимые десятичные цифры. Если таких цифр больше 7, то значение числа округляется к ближайшему, у которого не больше 7 значимых цифр.*

*Уточнение про преобразование из числа типа decimal в тип int:*
- *Если в числе типа decimal есть дробная часть, то её следует отбросить (например, 0.9 преобразуется 0)*

### Другие функции

| Описание | Функция                                                  | 
| ------ |----------------------------------------------------------|
| Округляет указанное Decimal число до ближайшего целого числа в сторону отрицательной бесконечности. | int st_floor(st_decimal value, st_decimal *result)    |	
| Округляет Decimal до ближайшего целого числа. | int st_round(st_decimal value, st_decimal *result)    |
| Возвращает целые цифры указанного Decimal числа; любые дробные цифры отбрасываются, включая конечные нули. | int st_truncate(st_decimal value, st_decimal *result) |
| Возвращает результат умножения указанного Decimal на -1. | int st_negate(st_decimal value, st_decimal *result)   |

Возвращаемое значение - код ошибки:
 - 0 - OK
 - 1 - ошибка вычисления

## Использование

Чтобы использовать библиотеку в своем проекте, добавьте заголовочный файл:
```c
#include <st_decimal.h>
```

А так же добавьте библиотеку при компиляции:
```
gcc file.c st_decimal.a -o execfile
```


### Пример использования

```c
#include "decimal.h"
#include <stdio.h>

int main() {
    st_decimal src1, src2, res;
    int code_check = 0;
    int code = 0;
    // src1 = 18446744073709551615;
    // src2 = 965453154;
    src1.bits[0] = 0b11111111111111111111111111110110;
    src1.bits[1] = 0b11111111111111111111111111111111;
    src1.bits[2] = 0b00000000000000000000000000001001;
    src1.bits[3] = 0b00000000000000010000000000000000;

    src2.bits[0] = 0b00111001100010111010010101100010;
    src2.bits[1] = 0b00000000000000000000000000000000;
    src2.bits[2] = 0b00000000000000000000000000000000;
    src2.bits[3] = 0b00000000000000000000000000000000;
    
    st_add(src1, src2, &result);
    ft_print_dec(result);
    bcd_t bcd_result = {0};
    ft_from_dec_to_bcd(result, &bcd_result);
    ft_print_bcd(bcd_result);
    return (0);
}
```
